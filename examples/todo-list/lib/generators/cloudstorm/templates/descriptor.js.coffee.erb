angular.module('<%= javascript_module_name %>', ['cloudstorm.rest-api'])

####################################################################################################
.factory '<%= javascript_resource_modul_name %>Resource', ['ResourceService', 'csRestApi', 'csResource', (ResourceService, csRestApi, csResource) ->
####################################################################################################

  class <%= class_name %> extends csResource

  ##################################################################################################

    @endpoint = 'api/v1/<%= plural_name %>'
    @member_endpoint = 'api/v1/<%= plural_name %>/{id}'

  ##################################################################################################

    @descriptor = {
      type: '<%= javascript_resource_name %>'
      name: '<%= class_name.humanize %>'
      hint: 'BLANK'

      fields: [
        # TODO: handle 'references' attribute type
        <%- attributes.each do |attribute| %>        { attribute: '<%= attribute.name %>', label: '<%= attribute.name %>', type: '<%= attribute.type %>', cardinality: 'one', required: false, read_only: false }
        <%- end %>
      ]
      <%- if has_name_attribute? %>
      display: {
        name:   'name'
        search: 'name_x_cont'
      }
      <%- end %>
    }

  ##################################################################################################

  ResourceService.register(<%= class_name %>.descriptor.type, <%= class_name %>)

  ##################################################################################################

  return <%= class_name %>

]
